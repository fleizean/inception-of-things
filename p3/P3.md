# P3 - k3d + ArgoCD (Alpine Linux)

Bu proje k3d kullanarak local Kubernetes cluster'ı ve ArgoCD ile GitOps kurulumu yapar. Alpine Linux tabanlı VM kullanır.

## Kurulum

```bash
vagrant up
vagrant ssh
```

## Erişim

### Ana Erişim (VM IP)
- **ArgoCD**: http://192.168.56.110:30080
- **Test App**: http://192.168.56.110:8888
- **VM IP**: 192.168.56.110

### Port Forward ile Erişim
- **ArgoCD**: http://localhost:30080
- **Test App**: http://localhost:8888

### Giriş Bilgileri
- **Kullanıcı**: admin
- **Şifre**: Kurulum sonrası gösterilir veya aşağıdaki komutla alınabilir

## Komutlar

```bash
# Cluster durumu
kubectl get nodes
kubectl get all -n argocd
kubectl get all -n dev

# ArgoCD şifresi
kubectl -n argocd get secret argocd-initial-admin-secret -o jsonpath="{.data.password}" | base64 -d

# Test
curl http://192.168.56.110:8888
curl http://localhost:8888

# k3d cluster yönetimi
k3d cluster list
k3d cluster stop iot
k3d cluster start iot
```

## Bileşenler

- **k3d**: Kubernetes in Docker
- **ArgoCD**: GitOps tool
- **kubectl**: Kubernetes CLI
- **ArgoCD CLI**: ArgoCD command line interface
- **Alpine Linux**: Base OS (generic/alpine319)

## Özellikler

- **Hafif**: Alpine Linux tabanlı, minimum resource kullanımı
- **Hızlı**: Reload gerektirmez, tek seferde kurulum
- **Tam entegrasyon**: ArgoCD + k3d tam konfigüre edilmiş
- **Port forwarding**: Hem VM IP hem localhost erişimi

## Troubleshooting

```bash
# Cluster durumu kontrol
k3d cluster list
kubectl cluster-info

# Cluster yeniden başlat
k3d cluster stop iot
k3d cluster start iot

# Logları kontrol et
kubectl logs -f -n argocd deployment/argocd-server

# Docker durumu
docker ps
service docker status

# VM içinde servis durumu
kubectl get all --all-namespaces
```

## Network Yapısı

- **VM Network**: 192.168.56.110 (Private Network)
- **Port Forwards**:
  - 8888:8888 → Test application
  - 30080:30080 → ArgoCD UI
- **k3d Load Balancer**: Port 8888 ve 30080 otomatik yönlendirme

## GitOps Workflow

1. ArgoCD GitHub repo'sunu izler: `https://github.com/mukeles123/mukeles42.git`
2. Değişiklikleri otomatik olarak dev namespace'ine deploy eder
3. Self-healing aktif: manuel değişiklikler otomatik geri alınır
4. Prune aktif: silinmiş kaynaklar otomatik temizlenir